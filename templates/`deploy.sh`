```bash
#!/bin/bash

# Deployment script for Good Parents Justice Flask App
# This script will deploy the application to Google Cloud App Engine

set -e  # Exit on any error

echo "üöÄ Starting deployment process for Good Parents Justice..."

# Colors for output
RED='33[0;31m'
GREEN='33[0;32m'
YELLOW='33[1;33m'
NC='33[0m' # No Color

# Check if gcloud is installed
if ! command -v gcloud &> /dev/null; then
    echo -e "${RED}‚ùå gcloud CLI not found. Please install Google Cloud SDK first.${NC}"
    echo "Visit: https://cloud.google.com/sdk/docs/install"
    exit 1
fi

echo -e "${GREEN}‚úÖ gcloud CLI found${NC}"

# Set the correct project
echo -e "${YELLOW}üîß Setting Google Cloud project...${NC}"
gcloud config set project good-parents-justice

# Verify project is set correctly
CURRENT_PROJECT=$(gcloud config get-value project)
if [ "$CURRENT_PROJECT" != "good-parents-justice" ]; then
    echo -e "${RED}‚ùå Failed to set project. Current project: $CURRENT_PROJECT${NC}"
    exit 1
fi

echo -e "${GREEN}‚úÖ Project set to: $CURRENT_PROJECT${NC}"

# Check if app.yaml exists
if [ ! -f "app.yaml" ]; then
    echo -e "${RED}‚ùå app.yaml not found in current directory${NC}"
    exit 1
fi

echo -e "${GREEN}‚úÖ app.yaml found${NC}"

# Check if requirements file exists
if [ ! -f "requirements.txt" ]; then
    echo -e "${RED}‚ùå requirements.txt not found${NC}"
    exit 1
fi

echo -e "${GREEN}‚úÖ Requirements file ready${NC}"

# Deploy to App Engine
echo -e "${YELLOW}üöÄ Deploying to Google App Engine...${NC}"
gcloud app deploy app.yaml --quiet --promote

if [ $? -eq 0 ]; then
    echo -e "${GREEN}‚úÖ Deployment successful!${NC}"
else
    echo -e "${RED}‚ùå Deployment failed${NC}"
    exit 1
fi

# Get the app URL
APP_URL=$(gcloud app describe --format="value(defaultHostname)")
echo -e "${GREEN}üåê Application deployed to: https://$APP_URL${NC}"

# Test the deployed application
echo -e "${YELLOW}üß™ Testing deployed application...${NC}"
sleep 10  # Wait for deployment to be ready

if curl -f https://$APP_URL/health > /dev/null 2>&1; then
    echo -e "${GREEN}‚úÖ Deployment test passed! Application is healthy.${NC}"
else
    echo -e "${YELLOW}‚ö†Ô∏è  Health check failed. Checking logs...${NC}"
    gcloud app logs tail --limit=20
fi

# Show useful commands
echo -e "${YELLOW}üìã Useful commands:${NC}"
echo "View logs: gcloud app logs tail"
echo "Open app: gcloud app browse"
echo "View versions: gcloud app versions list"

echo -e "${GREEN}üéâ Deployment process completed!${NC}"
echo -e "${YELLOW}Next steps:${NC}"
echo "1. Test your application at: https://$APP_URL"
echo "2. Set up custom domain using domain setup guide"
echo "3. Monitor logs: gcloud app logs tail"
```
